<htmlform formUuid="787608c8-512d-44fe-b793-fe54b660987a" formName="Ebola Triage"
          formEncounterType="4a8da825-2896-4f3f-be07-2c3d9214c040" formVersion="2.0">

    <h1>Triage</h1>

    <table>
        <tr>
            <td>
                <p>
                    <label>Date</label>
                    (automatic timestamp)
                    <span style="display: none">
                        <encounterDate showTime="true" default="now"/>
                    </span>
                </p>
            </td>
            <td>
                <p>
                    <label>Location</label>
                    <encounterLocation default="e0e18fea-6860-11e4-9305-df58197607bd"/>
                </p>
            </td>
            <td>
                <p>
                    <label>Provider</label>
                    <encounterProvider default="currentUser" required="true"/>
                </p>
            </td>
        </tr>
    </table>

    <section id="symptomAndCaseDef" sectionTag="fieldset" headerTag="legend" headerStyle="title"
             headerCode="Symptom and case definition">

        <p>
            <label>1. Sudden onset of a high fever?</label>
            <!-- TBD:  Need sudden fever, not fever -->
            <obsgroup groupingConceptId="CIEL:1727">
                <span class="symptom">
                    <obs conceptId="CIEL:1728" answerLabel="" answerConceptId="CIEL:140238"/>
                </span>
                <obs conceptId="CIEL:1729" answerConceptIds="CIEL:1065,CIEL:1066,CIEL:1067"
                     answerLabels="yes,no,unknown"/>
            </obsgroup>
        </p>

        <p>
            <label>2. Contact with a suspect/probable/known Ebola case?</label>
            <obsgroup groupingConceptId="CIEL:1727">
                <span class="symptom">
                    <obs conceptId="CIEL:1728" answerLabel="" answerConceptId="CIEL:162633"/>
                </span>
                <obs conceptId="CIEL:1729" answerConceptIds="CIEL:1065,CIEL:1066,CIEL:1067"
                     answerLabels="yes,no,unknown"/>
            </obsgroup>
        </p>

        <p>
            <label>3. Inexplicable bleeding?</label>
            <obsgroup groupingConceptId="CIEL:1727">
                <span class="symptom">
                    <obs conceptId="CIEL:1728" answerLabel="" answerConceptId="CIEL:162628"/>
                </span>
                <obs conceptId="CIEL:1729" answerConceptIds="CIEL:1065,CIEL:1066,CIEL:1067"
                     answerLabels="yes,no,unknown"/>
            </obsgroup>
        </p>

        <p>
            <label>4. Any of the following symptoms (check all that apply)?</label>
        </p>

        <table>
            <repeat>
                <template>
                    <obsgroup groupingConceptId="CIEL:1727">
                        <tr>
                            <td class="symptom">
                                <ifMode mode="VIEW" include="true">
                                    <lookup expression="fn.getConcept('{concept}').name"/>
                                </ifMode>
                                <ifMode mode="VIEW" include="false">
                                    <obs conceptId="CIEL:1728" answerConceptId="{concept}" labelText=""/>
                                </ifMode>
                            </td>
                            <td>
                                <obs conceptId="CIEL:1729" answerConceptIds="CIEL:1065,CIEL:1066"
                                     answerLabels="yes,no"/>
                            </td>
                        </tr>
                    </obsgroup>
                </template>
                <render concept="CIEL:139084" labelText="Headache"/>
                <render concept="CIEL:135595" labelText="Loss of appetite"/>
                <render concept="CIEL:116334" labelText="Lethargy"/>
                <render concept="CIEL:140501" labelText="Fatigue"/>
                <render concept="CIEL:133632" labelText="Muscle pain"/>
                <render concept="CIEL:80" labelText="Joint pain"/>
                <render concept="CIEL:122496" labelText="Difficult to breathe"/>

                <render concept="CIEL:122983" labelText="Vomiting"/>
                <render concept="CIEL:142412" labelText="Diarrhea"/>
                <render concept="CIEL:151" labelText="Abdominal pain"/>
                <render concept="CIEL:118789" labelText="Difficult to swallow"/>
                <render concept="CIEL:138662" labelText="Hiccups"/>
            </repeat>
        </table>

        <p>
            Case definition met if yes for
            <b>#1 &amp; #2</b>
            OR
            <b>#3</b>
            OR
            <b>#1 &amp; three from #4</b>
        </p>

        <p>
            <label>Does the patient meet the case definition?</label>
            <obs conceptId="CIEL:162620" answerConceptIds="CIEL:1065,CIEL:1066"
                 answerLabels="Yes - admit to ETU,No - patient leaves ETU"/>
        </p>

        <postSubmissionAction class="org.openmrs.module.ebolaexample.htmlformentry.EbolaTriagePostSubmissionAction"/>

    </section>

    <p></p>

    <section id="additionalInfo" sectionTag="fieldset" headerTag="legend" headerStyle="title"
             headerCode="Additional information">

        <p>
            <label>Can patient eat?</label>
            <!-- TBD obs conceptId="CIEL:" /> -->
        </p>

        <p>
            <label>If estimated age is under 12 months (1 year):</label>
        </p>

        <p>
            <label>Currently breastfed?</label>
            <obs conceptId="CIEL:5632" answerConceptIds="CIEL:1065,CIEL:1066,CIEL:1067"
                 answerLabels="yes,no,unknown"/>
        </p>
    </section>

    <ifMode mode="VIEW" include="false">
        <div id="buttons">
            <submit submitClass="confirm right"/>
            <button type="button" class="cancel"><uimessage code="general.cancel"/></button>
        </div>

        <script type="text/javascript">
            jQuery(function() {
                jQuery('.symptom input[type=checkbox]').prop('checked', true).hide();
            });
        </script>
    </ifMode>

</htmlform>